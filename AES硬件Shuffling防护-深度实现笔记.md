# AES硬件Shuffling防护-深度实现笔记

## 3.2 硬件Shuffling模块

### Benes网络与Omega网络对比
- Benes网络由56个开关组成，能够实现16!种置换。
- Omega网络由32个开关组成，能够实现2^32种置换。

### ASCII图示
```
Benes网络：
  +---+
  | 1 |
  +---+
   / \
  +---+
  | 2 |
  +---+
   / \
  +---+
  | 3 |
  +---+
```

```
Omega网络：
  +---+
  | A |
  +---+
   / \
  +---+
  | B |
  +---+
   / \
  +---+
  | C |
  +---+
```

### Trivium PRNG控制位生成
1. 初始化状态
2. 生成控制位
3. 输出控制位

### 随机控制位驱动开关的可视化
- 随机控制位示例：010101...

## 3.3 AES架构

### 数据通路图
- Din → MEMi → SB → MC → MEMo → Dout

### RAM替代寄存器的原因
- RAM支持置换，寄存器不支持。

### 表格1：P[cpt]的示例
| Index | Value |
|-------|-------|
| 0     | 10    |
| 1     | 12    |
| ...   | ...   |

### 表格2：P^-1构造算法
1. 初始化
2. 步骤1
3. 步骤2

### 内存地址随机化机制
- 示例：地址随机化的具体例子。

## 图4 调度时序

### 336个时钟周期的分解
- 初始化（32个周期）：16个用于Din + 16个用于WK0
- 第一轮（32个周期）：16个用于WK1 + 16个随机操作 + 16个MC完成
- 第二到第九轮（256个周期）：每轮32个周期
- 第十轮（16个周期）
- 输出（16个周期）

### ASCII时间线图
```
时间线：
|----32----|----32----|----256----|----16----|----16----|
```

## 4.1 安全性评估

### SNR分析
- -81.5dB（0级）至 -184.42dB（55级）

### 图5数据解读
- 数据解读内容。

### 图6 CPA攻击轨迹比较
- <100个轨迹（未保护） vs 100万条轨迹（已保护）

### 置换增加安全性
- 置换安全性提升10000倍的原因。

## 实现指南

### 置换表构造伪代码
```
function createPermutationTable() {
  // 伪代码实现
}
```

### AES计算与置换的伪代码
```
function AESWithShuffling() {
  // 伪代码实现
}
```

### 硬件资源使用
- Omega: 194 slices, 112.63 MHz, 42.90 Mbit/s

### 集成过程
1. 步骤1
2. 步骤2
3. 步骤3

---

此文件包含了AES硬件Shuffling防护的深度实现笔记，涵盖了从架构到安全评���的各个方面。